<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Probability | Preceptor’s Primer for Bayesian Big Data Science</title>
<meta name="author" content="David Kane">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.2.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script><link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet">
<script src="libs/str_view-binding-1.4.0/str_view.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Preceptor’s Primer for Bayesian Big Data Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preamble.html">Preamble</a></li>
<li><a class="" href="shopping-week.html">Shopping Week</a></li>
<li><a class="" href="visualization.html"><span class="header-section-number">1</span> Visualization</a></li>
<li><a class="" href="wrangling.html"><span class="header-section-number">2</span> Wrangling</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">3</span> Functions</a></li>
<li><a class="" href="rubin-causal-model.html"><span class="header-section-number">4</span> Rubin Causal Model</a></li>
<li><a class="active" href="probability.html"><span class="header-section-number">5</span> Probability</a></li>
<li><a class="" href="one-parameter.html"><span class="header-section-number">6</span> One Parameter</a></li>
<li><a class="" href="two-parameters.html"><span class="header-section-number">7</span> Two Parameters</a></li>
<li><a class="" href="three-parameters.html"><span class="header-section-number">8</span> Three Parameters</a></li>
<li><a class="" href="n-parameters.html"><span class="header-section-number">9</span> N Parameters</a></li>
<li><a class="" href="other-outcomes.html"><span class="header-section-number">10</span> Other Outcomes</a></li>
<li><a class="" href="building-models.html"><span class="header-section-number">11</span> Building Models</a></li>
<li><a class="" href="model-selection.html"><span class="header-section-number">12</span> Model Selection</a></li>
<li><a class="" href="tools.html">Tools</a></li>
<li><a class="" href="shiny.html">Shiny</a></li>
<li><a class="" href="maps.html">Maps</a></li>
<li><a class="" href="animation.html">Animation</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PPBDS/primer">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="probability" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Probability<a class="anchor" aria-label="anchor" href="#probability"><i class="fas fa-link"></i></a>
</h1>
<!-- Delete the cardinal virtues? -->
<!-- Add a bunch more code? Show how everything is done? -->
<!-- When discussing a parameter $p$ and a probability distribution p() in the absence of a specific context, then those simple terms are OK. But, whenever you are talking about specific parameters or specific probability distributions, you should have either subscripts or items in the parentheses, respectively.  -->
<!-- More animations. Create a movie which swoops into the joint distribution, takes a slice, remove the other slices, and then normalizes. Cool new package ggral (sp?) -->
<!-- We need a single example of a continuous distribution after Electoral Votes. It will also have math. And empirical. And posterior. -->
<!-- Revisit these references and see if there is other stuff we should include:   -->
<!-- Teaching Bayes' Rule: A Data-Oriented Approach by Jim Albert. -->
<!-- Rethinking Chapter 2. Garden of forking data is just excellent stuff. -->
<!-- Bayesian Workshop -->
<p>The central tension, and opportunity, in data science is the interplay between the <em>data</em> and the <em>science</em>, between our empirical observations and the models which we use to understand them. Probability is the language we use to explore that interplay; it connects models to data, and data to models.</p>
<div id="probability-distributions" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Probability distributions<a class="anchor" aria-label="anchor" href="#probability-distributions"><i class="fas fa-link"></i></a>
</h2>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-457"></span>
<img src="05-probability/images/probability_dice.jpeg" alt="Dice and Probability." width="100%"><p class="caption">
FIGURE 5.1: Dice and Probability.
</p>
</div>
<p>What does it mean that Trump has a <em>30% chance</em> of winning re-election this fall? That there is a <em>90% probability</em> of rain today? That the dice at the casino is <em>unfair</em>? If I roll that dice 10 times and five of those times I get a three, how likely is it that the dice is <em>unfair</em>?</p>
<p>Probability is about quantifying uncertainty. We can think of probability as a proportion. The probability of an event occurring is a number from 0 to 1, where 1 means that the event is 100% certain.</p>
<p>Let’s begin with the simplest events: coin flips and dice rolls. If the dice and
the coins are fair, we can operate under the assumption that all outcomes are
equally likely.</p>
<p>This allows us to make the following statements:</p>
<ul>
<li>The probability of rolling a 1 or 2 is 2/6, or 1/3.</li>
<li>The probability of rolling a 1, 2, 3, 4, 5, or 6 is 1.<br>
</li>
<li>The probability of flipping a coin and getting tails is 1/2.</li>
</ul>
<p>For the purposes of this course, a <em>probability distribution</em> is a mathematical object that covers a set of outcomes, where each distinct outcome has a chance of occurring between 0 and 1 inclusive. The set of possible outcomes — heads or tails for the coin, 1 through 6 for the dice — can be either discrete or continuous. This set of outcomes is the <em>domain</em> of the probability distribution. There are three types of probability distributions: mathematical, empirical, and posterior. Let’s walk through some examples to better understand each type of probability distribution.</p>
<p>Before we continue, we should be familiar with the notation used in this chapter. Whenever we are talking about a specific probability (represented by a single value), we will use <span class="math inline">\(p\)</span> with a <em>subscript</em>. For instance, <span class="math inline">\(p_h\)</span> = 0.5 denotes the probability of getting heads on a coin toss when the coin is fair. <span class="math inline">\(p_t\)</span> denotes the probability of getting tails on the coin toss. However, when we are referring to the entire probability distribution over a set of outcomes, we will use <span class="math inline">\(p\)</span> with <em>parentheses</em>. For example, the probability distribution of a coin toss is <span class="math inline">\(p(coin)\)</span>. That said, <span class="math inline">\(p(coin)\)</span> is composed of all the two specific probabilities mapped from the domain.</p>
<div id="flipping-a-coin" class="section level3" number="5.1.1">
<h3>
<span class="header-section-number">5.1.1</span> Flipping a coin<a class="anchor" aria-label="anchor" href="#flipping-a-coin"><i class="fas fa-link"></i></a>
</h3>
<p>A <em>mathematical distribution</em> is based on mathematical formulas. Assuming that the dice is perfectly fair, we should get heads as many times as we get tails.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-458-1.png" width="672"></div>
<p>An <em>empirical distribution</em> is based on data. You can think of this as the probability distribution created by running a simulation. In theory, if we increase the number of coins we flip in our simulation, the empirical distribution will look more and more similar to the mathematical distribution. The probability distribution is the Platonic form. The empirical distribution will often look like the mathematical probability distribution, but it will rarely be exactly the same.</p>
<p>In this simulation, there are 49 heads and 51 tails. The outcome will vary every time we run the simulation, but the proportion of heads to tails should not be too different if this coin is fair.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-459-1.png" width="672"></div>
<p>An <em>posterior distribution</em> is based on beliefs and expectations. It displays your belief about things you can’t see right now. You may have posterior distributions for events in the past, present, or future.</p>
<p>In the case of the coin toss, the posterior distribution changes depending on your beliefs. For instance, let’s say your friend brought a coin to school and asked to bet you. If the result is heads, you have to pay them $5.</p>
<p>This makes you suspicious; your posterior distribution would reflect this. You might believe that <span class="math inline">\(p_h\)</span> is 0.95 while <span class="math inline">\(p_t\)</span> is 0.05.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-460-1.png" width="672"></div>
</div>
<div id="rolling-two-dice" class="section level3" number="5.1.2">
<h3>
<span class="header-section-number">5.1.2</span> Rolling two dice<a class="anchor" aria-label="anchor" href="#rolling-two-dice"><i class="fas fa-link"></i></a>
</h3>
<p>Our <em>mathematical distribution</em> tells us that, with a fair dice, the probability of getting 1, 2, 3, 4, 5, and 6 are equal: there is a 1/6 chance of each. When we roll two dice at the same time and sum the values, the numbers closest to the middle (ex. 6, 7, 8) are more common sums than numbers at the very edge (ex. 2, 12) because there are more combinations of numbers that add up to the middle values.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-461-1.png" width="100%"></div>
<p>We get an <em>empirical distribution</em> by running a simulation and rolling two dice a hundred times. The result is not identical to the mathematical distribution because of the inherent randomness of the real world. We can observe that the <span class="math inline">\(p_2\)</span> and <span class="math inline">\(p_12\)</span>, which are displayed on the left and right most ends of the distribution, are far lower than the <span class="math inline">\(p_6\)</span>, for example.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-462-1.png" width="100%"></div>
<p>The <em>posterior distribution</em> for rolling one dice a hundred depends on your expectations. If you take the dice from your Monopoly set, you have reason to believe that the assumptions underlying the mathematical distribution are true. However, if you walk into a crooked casino and a host asks you to play craps, you might be suspicious. In craps, a come-out roll of 7 and 11 is a “natural” and the you win. You might expect those numbers to occur less often than they would with fair dice. Meanwhile, a come-out roll of 2, 3 is bad for someone betting what’s known as the “Pass line.” You might also expect values like 2 and 3 to occur more frequently. Your posterior distribution might look like this:</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-463-1.png" width="100%"></div>
<p>Someone less suspcious of the casina would have a posterior distribution which looks more like the mathematical distribution.</p>
</div>
<div id="presidential-elections" class="section level3" number="5.1.3">
<h3>
<span class="header-section-number">5.1.3</span> Presidential elections<a class="anchor" aria-label="anchor" href="#presidential-elections"><i class="fas fa-link"></i></a>
</h3>
<p>Now we let’s say we are building probability distributions for political events, like a presidential election. We want to know the probability that Democratic candidate wins x electoral votes, where x represents the range of possible outcomes from 0 to 538.</p>
<p>It would be incredibly naive to create the following <em>mathematical distribution</em>. We create a distribution by running a simulation 10,000 times, where the chances of the Democratic candidate winning any given electoral college vote is 0.5.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-464-1.png" width="100%"></div>
<p>We know that campaign platforms, donations, charisma, and many other factors will contribute to a candidate’s likeability. Elections are more complicated than coin tosses.</p>
<p>The <em>empirical distribution</em> in this case could involve looking into past elections in the United States and counting the number of electoral votes that the Democrats won in each. For the empirical distribution, we create a tibble with electoral vote results from past elections. Looking at elections since 1964, we can observe that the number of electoral votes that the Democrats received in each one is different. Given that we only have 14 entries, it is difficult to draw conclusions or make predictions based off of this empirical distribution.</p>
<p>However, this model is enough to suggest that the assumptions of the mathematical probability distribution above do not work for electoral votes. The model assumes that the Democrats have a 50% chance of receiving each of the 538 votes. Just looking at the mathematical probability distribution, we can observe that receiving 13 or 17 or 486 votes out of 538 would be extreme and almost impossible under this mathematical model. However, our empirical distribution tells us that those were real election results.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-465-1.png" width="100%"></div>
<p>The <em>posterior distribution</em> in the election case is something data scientists devote a lot of time to. The analysts develop algorithms that consider their expectations for each outcome. Consider this generated using data from <em>FiveThirtyEight</em>.</p>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   cycle = col_double(),
##   branch = col_character(),
##   model = col_character(),
##   modeldate = col_character(),
##   candidate_inc = col_character(),
##   candidate_chal = col_character(),
##   candidate_3rd = col_logical(),
##   evprob_inc = col_double(),
##   evprob_chal = col_double(),
##   evprob_3rd = col_logical(),
##   total_ev = col_double(),
##   timestamp = col_character(),
##   simulations = col_double()
## )</code></pre>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-466-1.png" width="100%"></div>
<p>Here is a posterior from the FiveThirtyEight website from August 13, 2020. This was created using the same data as the above distribution, but simply displayed differently. For each electoral result, the height of the bar represents the probability that a given event will occur. However, there is no numbered y-axis telling us what the specific probability of each outcome is.</p>
<div class="inline-figure"><img src="05-probability/images/fivethirtyeight.png" width="100%"></div>
<p>Here is the posterior from <em>The Economist</em>, also from August 13, 2020. This looks confusing at first because the data analysts have chosen to merge the axes for Republican and Democratic electoral votes. We can tell that the Economist is more optimistic about Biden’s odds in the election compared to Trump’s, relative to <em>FiveThirtyEight</em>.</p>
<div class="inline-figure"><img src="05-probability/images/economist_aug13.png" width="100%"></div>
<p>These two models, built by smart people using the similar data sources, have reached fairly different conclusions. Data science is difficult! There is not one “right” answer. Real life is not a problem set.</p>
<div class="figure">
<span id="fig:unnamed-chunk-469"></span>
<img src="05-probability/images/538_versus_Economist.png" alt="Watch the makers of these two models throw shade at each other on Twitter! Eliot Morris is one of the primary authors of the Economist model. Nate Silver is in charge of 538. They don't seem to be too impressed with each other's work! More smack talk [here](https://statmodeling.stat.columbia.edu/2020/08/31/more-on-that-fivethirtyeight-prediction-that-biden-might-only-get-42-of-the-vote-in-florida/) and [here](https://statmodeling.stat.columbia.edu/2020/08/31/problem-of-the-between-state-correlations-in-the-fivethirtyeight-election-forecast/)." width="100%"><p class="caption">
FIGURE 5.2: Watch the makers of these two models throw shade at each other on Twitter! Eliot Morris is one of the primary authors of the Economist model. Nate Silver is in charge of 538. They don’t seem to be too impressed with each other’s work! More smack talk <a href="https://statmodeling.stat.columbia.edu/2020/08/31/more-on-that-fivethirtyeight-prediction-that-biden-might-only-get-42-of-the-vote-in-florida/">here</a> and <a href="https://statmodeling.stat.columbia.edu/2020/08/31/problem-of-the-between-state-correlations-in-the-fivethirtyeight-election-forecast/">here</a>.
</p>
</div>
<p>There are many political science questions you could explore with posterior distributions and they can relate to the past, present, and future.</p>
<ul>
<li>Past: How many electoral votes would Hilary Clinton have won if she picked a different VP?</li>
<li>Present: What is the median height of Harvard students?</li>
<li>Future: How many electoral votes will a presidential candidate win?</li>
</ul>
</div>
<div id="working-with-probability-distributions" class="section level3" number="5.1.4">
<h3>
<span class="header-section-number">5.1.4</span> Working with probability distributions<a class="anchor" aria-label="anchor" href="#working-with-probability-distributions"><i class="fas fa-link"></i></a>
</h3>
<p>A probability distribution is not always easy to work with. It is a complex object. And, in many contexts, we don’t really care about all that complexity. So, instead of providing the full probability distribution, we often just use a summary measure, a number or two or three which captures the aspect of the entire distribution which is relevant to the matter at hand. Let’s explore these issues using the 538 posterior probability distribution, as of August 13, 2020, for the number of electoral votes which will be won by Joe Biden. Here is a tibble with 1,000,000 draws from that distribution:</p>
<div class="sourceCode" id="cb717"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">draws</span></code></pre></div>
<pre><code>## # A tibble: 1,000,000 x 2
##       ID electoral_votes
##    &lt;int&gt;           &lt;int&gt;
##  1     1             491
##  2     2             150
##  3     3             369
##  4     4             345
##  5     5             185
##  6     6             211
##  7     7             203
##  8     8             127
##  9     9             376
## 10    10             155
## # … with 999,990 more rows</code></pre>
<p>Recall the discussion from Section <a href="wrangling.html#distributions">2.9</a>. A distribution and a sample of draws from that distribution are different things. But, if you squint, there are sort of the same thing, at least for our purposes. For example, if you want to know the mean of the distribution, then the mean of the draws will be a fairly good estimate, especially if the number of draws is large enough.</p>
<p>The second way to represent a probability distribution in the computer is as a “draws” object. Recall from Chapter <a href="wrangling.html#wrangling">2</a> how we can draw randomly from specified probability distributions as so:</p>
<div class="sourceCode" id="cb719"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] -1.090  1.324  1.336  0.039 -1.233  0.794  0.448 -1.081 -0.025 -0.663</code></pre>
<div class="sourceCode" id="cb721"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] 0.45 0.04 0.34 0.89 0.38 0.88 0.52 0.91 0.81 0.61</code></pre>
<p>These elements of these vectors are all “draws” from the specified probability distributions. In most appplied situations, our tools will produce draws rather than summary objects. We can translate a summary object into a draws object like this:</p>
<p>Again, in practice, we almost never have to perform this transformation. We will just be given the draws object automatically. Fortunately, draws objects are very easy to work with:</p>
</div>
<div id="unnormalized-distributions" class="section level3" number="5.1.5">
<h3>
<span class="header-section-number">5.1.5</span> Unnormalized distributions<a class="anchor" aria-label="anchor" href="#unnormalized-distributions"><i class="fas fa-link"></i></a>
</h3>
<p>Remember that probability distributions are mathematical objects that cover a set of outcomes, where each outcome in the domain is mapped to a probability value between 0 and 1 inclusive and the sum of all mappings is 1. Sometimes, you may see distributions similar to probability distributions, only the y-axis displays raw counts instead of proportions. Unnormalized distributions are not probability distributions, but it is easy to convert between the two. You simply divide all the outcome counts on the y-axis by the sum of all outcome counts to “normalize” and unnormalized distribution. Unnormalized distributions are often an intermediary step; it is often handy to work with counts until the very end.</p>
<p>For instance, we can generate the following unnormalized distribution for the sum of rolling two dice (empirical distribution from running this simulation 100 times). You may notice that the shape of the distribution is the same as the empirical probability distribution we generated earlier, only the y-axis is labeled differently.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-475-1.png" width="100%"></div>
<!-- DK: Add normalized density plot. Comment that they look identical, just scaled. -->
<!-- after_stat("density") -->
</div>
<div id="joint-distributions" class="section level3" number="5.1.6">
<h3>
<span class="header-section-number">5.1.6</span> Joint distributions<a class="anchor" aria-label="anchor" href="#joint-distributions"><i class="fas fa-link"></i></a>
</h3>
<!-- DK: Should be p(A). Discuss p(A, B) -->
<p>Now we understand that <span class="math inline">\(p_A\)</span> can represent the probability distribution of outcomes for event A. Let’s talk about joint distributions, which can be represented by <span class="math inline">\(p_{A, B}\)</span>. Joint distributions are also mathematical objects that cover a set of outcomes, where each distinct outcome has a chance of occurring between 0 and 1 and the sum of all chances equals to 1. The key to a joint distribution is it measures the chance that both events A and B will occur simultaneously.</p>
<p>Let’s say that you are rolling two six-sided dice simultaneously. One is weighted so that there is a 50% chance of rolling a 6 and a 10% chance of each of the other values. The other is weighted so there is a 50% chance of rolling a 5 and a 10% chance of rolling each of the other values. Let’s roll both dice 1000 times. In previous examples involving two dice, we cared about the sum of results and not the outcomes of the first versus the second rolls of each simulation. With a joint distributions, the order matters so instead of 11 possible outcomes on the x-axis of our distribution graph (ranging from 2 to 12), we have 36. Furthermore, a 2D probability distribution is not sufficient to represent all of the variables involved, so the joint distribution for this example is displayed using a 3D plot.</p>
<div class="inline-figure"><img src="05-probability/images/joint.png" width="100%"></div>
</div>
</div>
<div id="tree-diagrams" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Tree diagrams<a class="anchor" aria-label="anchor" href="#tree-diagrams"><i class="fas fa-link"></i></a>
</h2>
<div id="independence" class="section level3" number="5.2.1">
<h3>
<span class="header-section-number">5.2.1</span> Independence<a class="anchor" aria-label="anchor" href="#independence"><i class="fas fa-link"></i></a>
</h3>
<p>So far, you have learned how to calculate <span class="math inline">\(p_A\)</span>, which is the fancy, statistical way of saying the probability of an event known as A. When flipping a coin, the probability of getting heads was 1/2. You have also learned how to compute the <span class="math inline">\(p_{A or B}\)</span>. This means the probability of either A or B happening. When rolling a dice, <span class="math inline">\(p_{1 or 2}\)</span>–the probability of getting a 1 or a 2–was 1/3.</p>
<p>What if you flipped 2 coins? You know that the probability of getting heads once is 1/2, but what are the odds of getting heads 2 times in a row? Let’s take a look at this tree diagram. We read this diagram from left to right. On the left, the probability of getting heads is 0.5. Now the tree branches out.</p>
<ul>
<li>
<em>If</em> we got heads the first time, then we go up the top branch. The probability of getting heads again is 0.5.</li>
<li>
<em>If</em> we got tails the first time, then we go down the bottom branch. The probability of getting heads is 0.5.</li>
</ul>
<p>Notice how regardless of what we get the first time we flip the coin, the probability of getting heads is 0.5 throughout. This suggests that the coin flips are <strong>independent</strong>. The result of one coin flip does not impact the likelihood of getting the same result next time. Take a look at the tree diagram. <span class="math inline">\(p_{H given H}\)</span> represents the probability of getting heads <em>given</em> that we got heads the first time. <span class="math inline">\(p_{H given T}\)</span> represents the probability of getting heads <em>given</em> that we got tails the first time. <span class="math inline">\(p_{H given H}\)</span> = <span class="math inline">\(p_{H given T}\)</span>.</p>
<div class="inline-figure"><img src="05-probability/images/tree-1.png" width="100%"></div>
</div>
<div id="conditional-probability" class="section level3" number="5.2.2">
<h3>
<span class="header-section-number">5.2.2</span> Conditional probability<a class="anchor" aria-label="anchor" href="#conditional-probability"><i class="fas fa-link"></i></a>
</h3>
<p>Now imagine that 60% of people in a community have a disease. A doctor develops a test to determine if a random person has the disease. However, this test isn’t 100% accurate. This test is 80% sure of correctly returning positive <strong>if the person has the disease</strong> and 90% sure of correctly returning negative <strong>if the person does not have the disease</strong>.</p>
<p>This tree diagram illustrates exactly this. Starting from the left, we see that the probability of a random person having the disease is 0.6. Since they either have the disease or don’t (those are the only two possibilities), the probability that they don’t have the disease is 1 - 0.4.</p>
<p>Now the tree branches out.</p>
<ul>
<li>
<em>If</em> the random person has the disease, then we go down the top branch. The probability of the person testing positive is 0.8 because the test is 80% sure of correctly returning positive when the person has the disease.</li>
<li>By the same logic, <em>if</em> the random person does not have the disease, we go down the bottom branch. The probability of the person incorrectly testing positive is 0.1.</li>
</ul>
<p>We decide to go down the top branch <em>if</em> our random person has the disease. We go down the bottom branch <em>if</em> they do not. This is called <strong>conditional probability</strong>. The probability of testing positive is <strong>dependent</strong> on whether the person has the disease.</p>
<p>How would you express this in statistical notation? <span class="math inline">\(p(A|B)\)</span> is the same thing as the probability of A <em>given</em> B. <span class="math inline">\(p(A|B)\)</span> essentially means the probability of A <em>if</em> we know for sure the value of B. You should also remember that <span class="math inline">\(p(A|B)\)</span> is not the same thing as <span class="math inline">\(p(B|A)\)</span>.</p>
<div class="inline-figure"><img src="05-probability/images/tree-2.png" width="100%"></div>
<!--TW: Need to find another up-to-date example for conditional probabality.

This concept of conditional probability is relevant in our everyday lives. For example, the probability of Trump’s re-election might be different than the probability of Trump’s re-election given that we are in a recession. The probability of you reading a textbook might vary, depending on the likelihood of your instructor cold-calling you in class. Whenever you encounter a question involving conditional probability, drawing a tree diagram is a very useful approach to visualization. -->
<!-- TW: Do we need this section? 


### Two diagrams for one set of coin flips

In our histogram probability distribution, we didn’t care what combinations of numbers made each sum. We only cared about the outcome. There are two ways of thinking about a coin toss as well. Your tree diagram should look different depending on whether the order of the results matters.

To understand tree diagrams a little better, imagine you’re flipping 2 coins. Your tree diagram may look different depending what you’re interested in measuring. In the following figure, the order of your coin toss results does not matter. We can imagine that you are rolling two coins together, or that you only care about the sum of the two dice values.

<img src="05-probability/images/tree-3.png" width="100%" />

In the next figure figure below, the order of your coin toss results does matter. Depending on your first result, you go down a different branch.

<img src="05-probability/images/tree-4.png" width="100%" />

-->
<!-- 2 b) Another coding session, but this time with list-columns and map_functions. These do not have to be long. We just want to re-iterate the points we made in words. Maybe we don't need list-columns. Maybe just show map functions here. Again, the point of this section is ONLY to understand the key probabity concepts: joint, total, conditional and marginal. -->
</div>
</div>
<div id="two-models" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Two models<a class="anchor" aria-label="anchor" href="#two-models"><i class="fas fa-link"></i></a>
</h2>
<!-- DK: Change this example so that 1% is not used twice, both for the prevalence of the disease and the accuracy of the test. -->
<p>You are in a city of 100,000 people. It is true that exactly 1% of the population has a disease, but we don’t know which people have it and which do not. In terms of a count, that means 1,000 people have this disease of the 100,000 in the population. We have a test which is 99% accurate. That is, if you have the disease there is a 99% chance that the test reports that you do, and the same if you don’t have the disease.</p>
<p>So, of the 1,000 people who truly do have the disease — where 1,000 is 1% of the 100,000 people in the city — 990 would correctly test positive and 10 would incorrectly test negative. This city also has 99,000 people who do not have the disease, 990 of which incorrectly test positive and 98,010 of which correctly test negative. That means that the number of people who would test positive for the disease is 1,980 but <em>only 990 of them have the disease</em>. So, in simple terms, the probability of you having the disease given a positive test is <span class="math inline">\(990\div1980\)</span>!</p>
<p>Here is the joint empirical distribution of the test result and disease status. Note that this is an unnormalized distribution because each dot represents a person in this city.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-481-1.png" width="100%"></div>
<p>Here is a joint distribution displayed in 3D. Instead of using the “jitter” feature in R to unstack the dots, we are using a 3D plot to visualize the number of dots in each box. The number of people who correctly test negative in this city is 98,010, far outweighing any of the other categories. There are 990 false positives, 990 true positives, and only 10 false negatives. This is why we can barely see the 3D bar coming from those sections.</p>
<div class="inline-figure"><img src="05-probability/images/rayshader_disease.png" width="100%"></div>
<p>This section is called “Two Models” because, for each person, there are two possible states of the world: have the disease and not have the disease. By assumption, there are no other possibilities. We call these two possible states of the world “models,” even though they are very simple models.</p>
<p>In addition to the two models, we have two possible results of our experiment on a given person: test positive or test negative. Again, this is an assumption. We do not allow for any other outcome. In later sections, we will look at more complex situations where we consider more than two models and more than two possible results of the experiment. In the meantime, we have built the <em>unnormalized joint distribution for models and results</em>. This is a key point! Look back earlier in this chapter where we discussed both unnormalized distributions and joint distributions.</p>
<p>Getting back to the figure, what is the difference between these distributions? How can they be useful in data analysis?</p>
<p>We want to analyze these plots by looking at different slices. For instance, let’s say that you have tested positive for the disease. Since the test is not always accurate, you cannot be 100% certain that you have it. We would isolate the slice where the test result equals 1 (meaning positive). If we zoom in on the plot, 990 people who tested positive have the disease and 990 who tested positive do not have the disease. In this case, we are focusing on one slice of the probability distribution where the test result was positive. There are two disease outcomes: positive or negative. By isolating a section, we are looking at a conditional distribution. Conditional on a positive test, you can visualize the likelihood of actually having the disease versus not.</p>
<p>This is what looks like when we take the slice where the test result is positive and zoom in. Taking a slice is the same thing as creating the conditional probability distribution.</p>
<div class="inline-figure"><img src="05-probability/images/rayshader_disease_zoom.png" width="100%"></div>
<p>We should rotate this slice and look at it from a 2D perspective. This looks very similar to what we saw at the beginning of the chapter when we flipped coins to create a probability distribution.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-484-1.png" width="100%"></div>
<p>This Stat 110 Animations video does a really good job of explaining a similar concept.</p>
<iframe src="https://www.youtube.com/embed/by3_weGwnMg?showcase=0" width="672" height="400px">
</iframe>
</div>
<div id="three-models" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Three models<a class="anchor" aria-label="anchor" href="#three-models"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-figure"><img src="05-probability/images/marble.jpg" width="100%"></div>
<p>Now, imagine that your friend gives you a bag with two marbles. There could either be two white marbles, two black marbles, or one of each color. Thus, the bag could contain 0% white marbles, 50% white marbles, or 100% white marbles. <span class="math inline">\(p\)</span> of white marbles could be 0, 0.5, or 1.</p>
<p>Let’s say you take a marble out of the bag, record whether it’s black or white, then return it to the bag. You repeat this three times, observing the number of white marbles you see out of three trials. You could get three whites, two whites, one white, or zero whites as a result of this trial. Let’s make what we call a Bayes scatterplot out of this. We have three models (three different proportions of white marbles in the bag) and four possible experimental results.</p>
<p>Here is the scatterplot visualization of the scenario:</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-487-1.png" width="100%"></div>
<p>Here is the 3D visualization:</p>
<div class="inline-figure"><img src="05-probability/images/three_models.png" width="100%"></div>
<p>The y-axes of both the scatterplot and the 3D visualization are labeled “Number of White Marbles in the Bag.” This is a model, a belief about the world you are not sure of. For instance. When the model is 0, we have no white marbles in the bag, meaning that none of the marbles we pull out in the sample will be white.</p>
<p>Let’s say you’ve got zero white marbles. We would isolate the slice where the result of the simulation involves three black marbles and zero white ones. Here is the unnormalized probability distribution.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-489-1.png" width="100%"></div>
<p>Next, let’s normalize the distribution.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-490-1.png" width="100%"></div>
<p>This plot makes sense because when all three marbles you draw out of the bag are NOT white, there is a pretty good chance that there are no white marbles in the bag. There is a smaller chance that the bag contains one black marble and one white marble. However, there is no chance that the bag only contains white marbles.</p>
<!-- # Section 5: 11 and the 1001 models. Same as coin example with unknown p as used in Albert example. First, p is 0, 0.1, 0.2, ... 0.9, 1.0. Make Bayes Scatterplot. Show marginals. Then, extend it so p takes on 1,001 values. This is how we go from discrete to continuous. All the same tricks apply. -->
</div>
<div id="n-models" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> N models<a class="anchor" aria-label="anchor" href="#n-models"><i class="fas fa-link"></i></a>
</h2>
<!-- 5 a) Now go on to Rethinking approach. I think that chapter 2 is just genius. Bayesian is really just counting. Maybe we do a very similar example to what he does? Maybe different? I am still pondering this myself. I think that there is a deep relationship here. In the simple Bayes rule decision trees, we know all the probabilities. But what if we don't? Instead, we get to observe lots of data (which are counts!) and then, from that data, figure out the probabilities. (Note that Rethinking does not talk like this --- after all, we know all the probabilities since each marble has a 20% chance of being drawn --- but I think it is implicit in his approach.) Key issue: Can we connect this in a sensible way to Bayesian scatterplot. There is always the data and the model and the relationship between the two. (And "the model" means, mainly, the parameter estimates thereof.) Tell me the data, and I will tell you the model. Tell me the model, and I will tell you the model. -->
<!-- Note the connection between the marbles from Rethinking and the Bayesian scatterplot. In figure 2.2 in Rethinking represents the model where p = 0.25, where p is the proportion of blue marbles in the total collection. The y-axis models would be labeled with p = 0, 0.25, 0.5, 0.75, and 1. With the tree marble diagram in figure 2.2, we would be taking random samples with 3 marbles. The number of blue marbles we get each time would be plotted along p = 0.25. This is another example of model on the y-axis and data on the x-axis. -->
<!-- DK: Should we cut out p = 0 and p = 1 as too annoying to deal with? -->
<div class="inline-figure"><img src="05-probability/images/heads.jpg" width="100%"></div>
<p>Assume that there is a coin with <span class="math inline">\(p_h\)</span>. I guarantee that there are only 11 possible values of <span class="math inline">\(p_h\)</span>: <span class="math inline">\(0, 0.1, 0.2, ..., 0.9, 1\)</span>. In other words, there are 11 possible models, 11 things which might be true about the world. This is just like situations we have previously discussed, except that there are more models to consider.</p>
<p>We are going to run an experiment in which you flip the coin 20 times and record the number of heads. What does this result tell you about the value of <span class="math inline">\(p_h\)</span>? Ultimately, we will want to calculate a posterior distribution of <span class="math inline">\(p_h\)</span>, which is written as p(<span class="math inline">\(p_h\)</span>).</p>
<p>To start, it is useful to consider all the things which might happen if, for example, <span class="math inline">\(p_h = 0.4\)</span>. Fortunately, the R functions for simulating random variables makes this easy.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-492-1.png" width="100%"></div>
<p>First, notice that many different things can happen! Even if we <em>know</em>, for certain, that <span class="math inline">\(p_h = 0.4\)</span>, many outcomes are possible. Life is remarkably random. Second, the most likely result of the experiment is 8 heads, as we would expect. Third, we have transformed the raw counts of how many times each total appeared into a probability distribution. Sometimes, however, it is convenient to just keep track of the raw counts. The shape of the figure is the same in both cases.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-493-1.png" width="100%"></div>
<p>Either way, the figures show what would have happened if that model — that <span class="math inline">\(p_h = 0.4\)</span> — were true.</p>
<p>We can do the same thing for all 11 possible models, calculating what would happen if each of them were true. This is somewhat counterfactual since only one of them can be true. Yet this assumption does allow us to create the <em>joint distribution</em> of <em>models which might be true</em> and of <em>data which our experiment might generate</em>. Let’s simplify this is p(models, data), although you should keep the precise meaning in mind.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-494-1.png" width="100%"></div>
<p>Here is the 3D version of the same plot.</p>
<div class="inline-figure"><img src="05-probability/images/n_models.png" width="100%"></div>
<p>In both of these idagrams, we see 11 models and 21 outcomes. We don’t really care about the p(<span class="math inline">\(models\)</span>, <span class="math inline">\(data\)</span>), the joint distribution of the models-which-might-be-true and the data-which-our-experiment-might-generate. Instead, we want to estimate <span class="math inline">\(p\)</span>, the unknown parameter which determines the probability that this coin will come up heads when tossed. The joint distribution alone can’t tell us that. We <em>created</em> the joint distribution before we had even conducted the experiment. It is our creation, a tool which we use to make inferences. Instead, we want the conditional distribution, p(<span class="math inline">\(models\)</span> | <span class="math inline">\(data = 8\)</span>). We have the results of the experiment. What do those results tell us about the probability distribution of <span class="math inline">\(p\)</span>?</p>
<p>To answer this question, we simply take a vertical <em>slice</em> from the joint distribution at the point of the x-axis corresponding to the results of the experiment.</p>
<p>This animation shows what we want to do with joint distributions. We take a slice (the red one), isolate it, rotate it to look at the conditional distribution, normalize it (change the values along the current z-axis from counts to probabilities), then observe the resulting posterior.</p>
<div class="inline-figure"><img src="05-probability/animations/color_red_combo.gif"></div>
<p>This is the only part of the joint distribution that we care about. We aren’t interested in what the object looks like where, for example, the number of heads is 11. That portion is irrelevant because we observed 8 heads, not 11. By using the filter function on the simulation tibble we created, we can conclude that there are a total of 465 times in our simulation in which 8 heads were observed.</p>
<p>As we would expect, most of the time when 8 coin tosses came up heads, the value of <span class="math inline">\(p\)</span> was 0.4. But, on numerous occasions, it was not. It is quite common for a value of <span class="math inline">\(p\)</span> like 0.3 or 0.5 to generate 8 heads. Consider:</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-496-1.png" width="100%"></div>
<p>Yet this is a distribution of raw counts. It is an unnormalized density. To turn it into a proper probability density (i.e., one in which the sum of the probabilities across possible outcomes sums to one) we just divide everything by the total number of observations.</p>
<div class="inline-figure"><img src="book_temp_files/figure-html/unnamed-chunk-497-1.png" width="100%"></div>
<p>The most likely value of <span class="math inline">\(p_h\)</span> is still 0.4, as before. But, it is much more likely that <span class="math inline">\(p\)</span> is either 0.3 or 0.5. And there is about an 8% chance that <span class="math inline">\(p_h \ge 0.6\)</span>.</p>
<p>You might be wondering: what is the use of a model? Well, let’s say we toss the coin 20 times and get 8 heads again. Given this result, what is the probability that future samples of 20 flips will result in 10 or more heads?</p>
<p>There are three main ways you could go about solving this problem with simulations.</p>
<p>The first <em>wrong</em> way to do this is assuming that <span class="math inline">\(p_h\)</span> is certain because we observed 8 heads after 20 tosses. We would conclude that 8/20 gives us 0.4. The big problem with this is that you are ignoring your uncertainty when estimating <span class="math inline">\(p_h\)</span>. This would lead us to the following code.</p>
<div class="sourceCode" id="cb723"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fl">10000000</span>

<span class="va">odds</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>sim_ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">sims</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>heads <span class="op">=</span> <span class="fu">map_int</span><span class="op">(</span><span class="va">sim_ID</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">20</span>, p <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">heads</span> <span class="op">&gt;=</span> <span class="fl">10</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span><span class="op">(</span>success <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">/</span><span class="va">sims</span><span class="op">)</span>

<span class="va">odds</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   success
##     &lt;dbl&gt;
## 1   0.245</code></pre>
<p>The second method involves sampling the whole posterior distribution vector we previously created. This would lead to the following correct code.</p>
<div class="sourceCode" id="cb725"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_draws</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>heads <span class="op">=</span> <span class="fu">map_int</span><span class="op">(</span><span class="va">p</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">20</span>, p <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">heads</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span>
  
<span class="va">odds</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">p_draws</span><span class="op">$</span><span class="va">p</span>, size <span class="op">=</span> <span class="va">sims</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>heads <span class="op">=</span> <span class="fu">map_int</span><span class="op">(</span><span class="va">p</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">20</span>, p <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">heads</span> <span class="op">&gt;=</span> <span class="fl">10</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span><span class="op">(</span>success <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">/</span><span class="va">sims</span><span class="op">)</span>

<span class="va">odds</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   success
##     &lt;dbl&gt;
## 1   0.328</code></pre>
<p>Third way is to sample from the actual distribution, which is a small dataset with just a few rows, but it includes both <span class="math inline">\(p_h\)</span> and the probability of each <span class="math inline">\(p_h\)</span>. This also gives the correct answer.</p>
<div class="sourceCode" id="cb727"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_posterior</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">heads</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span><span class="op">(</span>total <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>probs <span class="op">=</span> <span class="va">total</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span>

<span class="va">odds</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">p_posterior</span><span class="op">$</span><span class="va">p</span>, 
                  size <span class="op">=</span> <span class="va">sims</span>, prob <span class="op">=</span> <span class="va">p_posterior</span><span class="op">$</span><span class="va">probs</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>heads <span class="op">=</span> <span class="fu">map_int</span><span class="op">(</span><span class="va">p</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">20</span>, p <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">heads</span> <span class="op">&gt;=</span> <span class="fl">10</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span><span class="op">(</span>success <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">/</span><span class="va">sims</span><span class="op">)</span>

<span class="va">odds</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   success
##     &lt;dbl&gt;
## 1   0.320</code></pre>
<p>As you may have noticed, if you calculated the value using the first method, you would believe that getting 10 or more heads is less likely than it really is. If you were to run a casino based on these assumptions, you will lose all your money. It is very important to be careful about the assumptions you are making. We tossed a coin 20 times and got 8 heads. However, you would be wrong to assume that <span class="math inline">\(p_h\)</span> = 0.4 just based on this result.</p>
<!-- ## Testing is evil -->
<!-- Introduce concepts like the null model, testing, and p-values. Connect to permutation tests from chapter 3.  Side note quotation: "Amatuers test. Professionals summarize." Maybe we should pick an example in which the number of heads is low enough to provide some reasonable evidence against p = 0.5. -->
<!-- In some fields, it is common to want to test a specific hypothesis. Consider the hypothesis that the coin is fair, i.e., that $p = 0.5$. Does the data we have support or reject that hypothesis? (Be wary that $p$ is both used for the probability of a head and the $p$-value of a hypothesis test.) -->
<!-- Not really interested in that exact test except in toy scenarios. -->
<!-- Difference between 0.04 and 0.06 is rarely significant. And is hardly ever a good reason to decide X over Y. -->
</div>
<div id="wisdom" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> Wisdom<a class="anchor" aria-label="anchor" href="#wisdom"><i class="fas fa-link"></i></a>
</h2>
<p>This <em>Primer</em> contains four important themes that are relevant in all chapters: Wisdom, Temperance, Courage, and Justice. As you move through the textbook, you will be building on and refining these concepts.</p>
<div class="figure">
<span id="fig:unnamed-chunk-501"></span>
<img src="other/images/Wisdom.jpg" alt="Wisdom." width="100%"><p class="caption">
FIGURE 5.3: Wisdom.
</p>
</div>
<p>The first theme of Wisdom is about whether the numbers we have capture the concepts we care about. We should be concerned about whether our data and models are representative of the problem.</p>
<p>Parameter uncertainty is a reason to exercise Wisdom. Suppose your friend sets up a pseudo-casino in the playground of the neighborhood school. She’s offering everyone the opportunity to play probability games and bet money. The first game is simple: coin tosses. If the coin lands on heads, you get five dollars. If it lands on tails, you pay three dollars.</p>
<p>You have a sneaking suspicion that the coin isn’t fair and you ask your friend to flip it 10 times to test your theory. However, you must not be overconfident. 10 observations might be too few to judge the fairness of the coin. Perhaps your friend secretly switches coins when it comes time for the actual betting and your sample in the initial simulation is not representative. You might be nervous about losing your money and even miscount the number of heads and tails. These are all examples of <em>parameter uncertainty</em>. Sometimes, a model has the correct form, but it’s not practical to run the simulation millions of times to be certain of the outcome. It’s not possible to be absolutely certain that your friend isn’t switching coins. A perfect world does not exist, so we must have reservations when drawing likely conclusions.</p>
<p>We need to be aware that sometimes it is not possible to capture all the variables we care about. However, as long as we are prudent, we can still interpret the data.</p>
</div>
<div id="justice" class="section level2" number="5.7">
<h2>
<span class="header-section-number">5.7</span> Justice<a class="anchor" aria-label="anchor" href="#justice"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<span id="fig:unnamed-chunk-502"></span>
<img src="other/images/Justice.jpg" alt="Justice." width="100%"><p class="caption">
FIGURE 5.4: Justice.
</p>
</div>
<p>Justice in data science is all about making sure that are models are as “fair” and unbiased as possible. Model structure is one of the most important ideas under the theme of Justice.</p>
<p>In the section about N models, we talked about the number of heads we would get from flipping a coin 20 times. One of the important parts of model structure is compressing ideas like the coin toss experiment into mathematical expressions.</p>
<p>For instance, a Bernouli distribution is where <span class="math inline">\(n = 1\)</span>. In the following expression, we are assuming the default value of n = 1, where we flip a coin one time. H represents the observation (i.e. is the result heads of tails). The tilda tells us we are making observations from an experiment. The B() represents a binomial distribution because the result of the experiment is either 0 or 1, tails or heads. <span class="math inline">\(p\)</span> in the expression represents the probability of heads.</p>
<p><span class="math display">\[ H \sim B(p) \]</span>
The following is a slightly more comprehensive expression, which takes different values of n into account. We might flip the coin 1 time, 2 times, etc.</p>
<p><span class="math display">\[ H \sim B(p, n)\]</span></p>
<p>This is the experiment we simulated in the section about N models. We flipped a coin 20 times and observed the number of heads we got. We worked with different values of <span class="math inline">\(p\)</span> to create the scatterplot and 3D visualization earlier in this chapter.</p>
<p><span class="math display">\[ H \sim B(p, n = 20)\]</span>
Another question to consider is whether the models we generate while calculating probabilities are predictive or causal. Knowing the difference helps us fairly interpret the data. Every model is predictive in the sense that, if you give me new data drawn from a stable distribution, I can give you a predictive forecast. But only a subset of those models are causal, meaning that, for a given individual, you can change the value of one input and figure out what the new output would be and then, from that, calculate the causal effect.</p>
<p>For the purposes of this chapter, everything we worked with was predictive. We did not attempt to make causal claims. If we wanted to make a causal claim, we would need to feature at least two different ways of doing an experiment. For instance, we could look at how the way in which you flip a coin affects the outcome. We could compare the number of heads we get from catching a coin in the air versus letting it fall to the ground. An important part of Justice is understanding the distinction between predictive and causal models.</p>
</div>
<div id="courage" class="section level2" number="5.8">
<h2>
<span class="header-section-number">5.8</span> Courage<a class="anchor" aria-label="anchor" href="#courage"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<span id="fig:unnamed-chunk-503"></span>
<img src="other/images/Courage.jpg" alt="Courage." width="100%"><p class="caption">
FIGURE 5.5: Courage.
</p>
</div>
<p>Data science involves words, math, and code. Code is the most important element. Turning an idea into code requires <em>Courage</em>.</p>
<p>Courage helps us account for unmodeled variation. Recall the following equation.</p>
<p><span class="math display">\[outcome = model + what \ is \ not \ in \ the \ model\]</span></p>
<p>A residual is the variation that is not contained in the model. This is explains why the result is equal to the fitted (also known as expected) value plus the residual (what is not in the model). However, no matter how nuanced our model becomes, we will not be able to make perfect predictions. Some randomness is intrinsic. For instance, the behavior of one individual can change and can’t be perfectly predicted even if a model accounts for what a group does on average.</p>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-504"></span>
<img src="05-probability/images/de_finetti.jpg" alt='Bruno de Finetti, an Italian statistician who wrote a famous treatise on the theory of probability that began with the statement "PROBABILITY DOES NOT EXIST." This is because probability only exists subjectively in our minds. It is a tool people made up and use for broad-stroke estimates.'><p class="caption">
FIGURE 5.6: Bruno de Finetti, an Italian statistician who wrote a famous treatise on the theory of probability that began with the statement “PROBABILITY DOES NOT EXIST.” This is because probability only exists subjectively in our minds. It is a tool people made up and use for broad-stroke estimates.
</p>
</div>
<p><em>Prediction uncertainty</em> highlights our ability, or lack thereof, to predict the future. This can be conceptualized as either an attempt to forecast the literal future or as an attempt to model data points which have been left out of the original analysis in some way. Prediction uncertainty has two primary sources that we previously discussed: <em>parameter uncertainty</em> and <em>unmodeled variation</em>.</p>
</div>
<div id="temperance" class="section level2" number="5.9">
<h2>
<span class="header-section-number">5.9</span> Temperance<a class="anchor" aria-label="anchor" href="#temperance"><i class="fas fa-link"></i></a>
</h2>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-505"></span>
<img src="other/images/Temperance.jpg" alt="Temperance." width="100%"><p class="caption">
FIGURE 5.7: Temperance.
</p>
</div>
<p>Models are often not as good as they appear. It’s important to be patient and understand the pitfalls of the data you have created.</p>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-506"></span>
<img src="05-probability/images/donald_rumsfeld.jpg" alt="Donald Rumsfeld." width="50%"><p class="caption">
FIGURE 5.8: Donald Rumsfeld.
</p>
</div>
<p>Donald Rumsfeld, the former US Secretary of Defense, once said the following tongue-twisting quote:</p>
<p>“There are known knowns. There are things we know we know. We also know there are known unknowns. That is to say, we know there are some things we do not know. But there are also unknown unknowns, the ones we do not know we do not know.”</p>
<div class="figure">
<span id="fig:unnamed-chunk-507"></span>
<img src="05-probability/images/Three_Card_Monte.jpg" alt="Three Card Monte." width="100%"><p class="caption">
FIGURE 5.9: Three Card Monte.
</p>
</div>
<p>What does this mean? Well imagine a crowd playing Three Card Monte in the streets of New York. The guy running the game runs a demo and shows you all the cards to make you confident. They earn money by making you overconfident and persuading you to bet. Your odds may seem good during the demo round, but that doesn’t actually say anything about what will likely happen when the real, high stakes game begins. The person running the game does many simulations, making the “victim” forget that they cannot actually make any conclusions about the odds of winning. There are some variables that we simply do not know even if we put a lot of effort into making posterior probability distributions. People can be using slight of hand, for instance.</p>
<p>We need patience in order to study and understand the unknown unknowns in our data. Patience is also important when we analyze the “realism” of our models. When we created the mathematical probability distribution for presidential elections, for instance, we assumed that the Democratic candidate would have a 50% chance of winning each vote in the electoral college. By comparing the mathematical model to our empirical cases, however, we recognize that the mathematical model is unlikely to be true. The mathematical model suggested that getting fewer than 100 votes is next to impossible, but many past Democratic candidates in the empirical distribution received less than 100 electoral votes.</p>
</div>
<div id="conclusion-1" class="section level2" number="5.10">
<h2>
<span class="header-section-number">5.10</span> Conclusion<a class="anchor" aria-label="anchor" href="#conclusion-1"><i class="fas fa-link"></i></a>
</h2>
<p>Throughout this chapter, we spent time going through examples of conditional distributions. However, it’s worth noting that all probability distributions are conditional on something. Even in the most simple examples, when we were flipping a coin multiple times, we were assuming that the probability of getting heads versus tails did not change between tosses.</p>
<p>We also discussed the difference between empirical, mathematical, and posterior probability distributions. Even though we developed these heuristics to better understand distributions, every time we make a claim about the world, it is based on our beliefs - what we think about the world. We could be wrong. Our beliefs can differ. Two reasonable people can have conflicting beliefs about the fairness of a dice.</p>
<p>It is useful to understand the three types of distributions and the concept of conditional distributions, but almost every probability distribution is conditional and posterior. We can leave out both words in future discussions, as we generally will in this book. They are implicit.</p>
<p>If you are keen to learn more about probability, here is a video featuring Professor Gary King. This is a great way to review some of the concepts we covered in this chapter.</p>
<iframe src="https://www.youtube.com/embed/6C7yRBfh2ok?showcase=0" width="672" height="400px">
</iframe>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="rubin-causal-model.html"><span class="header-section-number">4</span> Rubin Causal Model</a></div>
<div class="next"><a href="one-parameter.html"><span class="header-section-number">6</span> One Parameter</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#probability"><span class="header-section-number">5</span> Probability</a></li>
<li>
<a class="nav-link" href="#probability-distributions"><span class="header-section-number">5.1</span> Probability distributions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#flipping-a-coin"><span class="header-section-number">5.1.1</span> Flipping a coin</a></li>
<li><a class="nav-link" href="#rolling-two-dice"><span class="header-section-number">5.1.2</span> Rolling two dice</a></li>
<li><a class="nav-link" href="#presidential-elections"><span class="header-section-number">5.1.3</span> Presidential elections</a></li>
<li><a class="nav-link" href="#working-with-probability-distributions"><span class="header-section-number">5.1.4</span> Working with probability distributions</a></li>
<li><a class="nav-link" href="#unnormalized-distributions"><span class="header-section-number">5.1.5</span> Unnormalized distributions</a></li>
<li><a class="nav-link" href="#joint-distributions"><span class="header-section-number">5.1.6</span> Joint distributions</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#tree-diagrams"><span class="header-section-number">5.2</span> Tree diagrams</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#independence"><span class="header-section-number">5.2.1</span> Independence</a></li>
<li><a class="nav-link" href="#conditional-probability"><span class="header-section-number">5.2.2</span> Conditional probability</a></li>
</ul>
</li>
<li><a class="nav-link" href="#two-models"><span class="header-section-number">5.3</span> Two models</a></li>
<li><a class="nav-link" href="#three-models"><span class="header-section-number">5.4</span> Three models</a></li>
<li><a class="nav-link" href="#n-models"><span class="header-section-number">5.5</span> N models</a></li>
<li><a class="nav-link" href="#wisdom"><span class="header-section-number">5.6</span> Wisdom</a></li>
<li><a class="nav-link" href="#justice"><span class="header-section-number">5.7</span> Justice</a></li>
<li><a class="nav-link" href="#courage"><span class="header-section-number">5.8</span> Courage</a></li>
<li><a class="nav-link" href="#temperance"><span class="header-section-number">5.9</span> Temperance</a></li>
<li><a class="nav-link" href="#conclusion-1"><span class="header-section-number">5.10</span> Conclusion</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PPBDS/primer/blob/master/05-probability.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PPBDS/primer/edit/master/05-probability.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Preceptor’s Primer for Bayesian Big Data Science</strong>" was written by David Kane. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
